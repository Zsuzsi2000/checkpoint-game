<form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
  <ion-list class="ion-padding">
    <ion-item>
      <ion-label position="floating">E-mail *</ion-label>
      <ion-input
        type="email"
        email
        labelPlacement="floating"
        placeholder="Type your email here"
        formControlName="email"
      ></ion-input>
    </ion-item>
    <ion-item
      *ngIf="(!profileForm.get('email').valid && profileForm.get('email').touched)"
      lines="none"
    >
      <ion-label color="danger">
        Should be a valid email address.
      </ion-label>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Username *</ion-label>
      <ion-input
        type="text"
        labelPlacement="floating"
        placeholder="Enter a username"
        formControlName="username"
      ></ion-input>
    </ion-item>
    <ion-item
      *ngIf="(!profileForm.get('username').valid && profileForm.get('username').touched)"
      lines="none"
    >
      <ion-label color="danger">
        Username is required.
      </ion-label>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Password *</ion-label>
      <ion-input
        type="password"
        labelPlacement="floating"
        placeholder="Type your password here"
        formControlName="password"
      ></ion-input>
    </ion-item>
    <ion-item
      *ngIf="(!profileForm.get('password').valid && profileForm.get('password').touched)"
      lines="none"
    >
      <ion-label color="danger">
        Should at least be 6 characters long.
      </ion-label>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Password again *</ion-label>
      <ion-input
        type="password"
        labelPlacement="floating"
        placeholder="Type your password here again"
        formControlName="passwordAgain"
      ></ion-input>
    </ion-item>
    <ion-item
      *ngIf="profileForm.hasError('passwordMismatch') && (profileForm.get('passwordAgain').dirty || profileForm.get('passwordAgain').touched)"
      lines="none"
    >
      <ion-label color="danger">
        Passwords do not match.
      </ion-label>
    </ion-item>
    <ion-item [button]="true" [detail]="false" id="select-country">
      <ion-label>Country</ion-label>
      <div slot="end" id="selected-country">{{ selectedCountry }}</div>
    </ion-item>
    <app-image-picker (imagePick)="onImagePick($event)"
                      [showPreview]="profileForm.get('picture').value"></app-image-picker>
  </ion-list>
  <ion-button
    class="ion-no-margin"
    type="submit"
    color="primary"
    expand="full"
    [disabled]="!profileForm.valid">
    Signup
  </ion-button>
</form>
<ion-modal trigger="select-country" #modal>
  <ng-template>
    <app-pick-a-thing
      class="ion-page"
      [countries]="countries"
      [selectedCountry]="selectedCountry"
      (selectionChange)="countrySelectionChanged($event)"
      (selectionCancel)="modal.dismiss()"
    ></app-pick-a-thing>
  </ng-template>
</ion-modal>
