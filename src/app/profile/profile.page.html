<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Profile</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="editProfile()">
        <ion-icon name="pencil"></ion-icon>
      </ion-button>
      <ion-button (click)="startDeleteTheProfile()">
        <ion-icon name="trash"></ion-icon>
      </ion-button>
      <ion-button>
        <ion-icon name="settings-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid class="ion-no-padding ion-no-margin">
    <ion-row>
      <ion-col class="ion-text-center" *ngIf="isLoading; else isNotLoading">
        <ion-spinner color="primary"></ion-spinner>
      </ion-col>
      <ng-template #isNotLoading>
        <ion-col class="ion-align-items-center ion-justify-content-center">
          <ion-avatar id="profile-picture">
            <img alt="Profile picture" [src]="loadedUser.picture"/>
          </ion-avatar>
        </ion-col>
        <ion-col>
          <ion-list class="ion-no-padding ion-no-margin" lines="none">
            <ion-item class="ion-no-padding ion-no-margin">
              <ion-label class="ion-no-padding ion-no-margin">
                <h2>Username</h2>
                <p>{{ loadedUser.username }}</p>
              </ion-label>
              <ion-button slot="end" (click)="editUsernameAlert()">
                <ion-icon name="pencil"></ion-icon>
              </ion-button>
            </ion-item>
            <ion-item class="ion-no-padding ion-no-margin">
              <ion-label class="ion-no-padding ion-no-margin">
                <h2>Email</h2>
                <p>{{ loadedUser.email }}</p>
              </ion-label>
              <ion-button slot="end" (click)="editEmailAlert()">
                <ion-icon name="pencil"></ion-icon>
              </ion-button>
            </ion-item>
            <ion-item class="ion-no-padding ion-no-margin">
              <ion-label class="ion-no-padding ion-no-margin">
                <h2>Country</h2>
                <p>{{ loadedUser.country }}</p>
              </ion-label>
              <ion-button slot="end">
                <ion-icon name="pencil"></ion-icon>
              </ion-button>
            </ion-item>
          </ion-list>
        </ion-col>
      </ng-template>
    </ion-row>
    <ion-row>
      <ion-col>
        <ion-segment (ionChange)="onFilterUpdate($event)" value="games">
          <ion-segment-button value="games">
            <ion-label>Own games</ion-label>
            <ion-icon name="game-controller-sharp"></ion-icon>
          </ion-segment-button>
          <ion-segment-button value="events">
            <ion-label>Upcoming events</ion-label>
            <ion-icon name="calendar"></ion-icon>
          </ion-segment-button>
        </ion-segment>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size-xs="12"  size-md="6"
               class="ion-align-items-center"
               *ngFor="let game of loadedOwnGames">
        <ion-card class="dark-card">
          <div class="background-image-container"><ion-img [src]="game.imgUrl" class="background-image"></ion-img></div>
          <ion-card-header class="ion-no-padding">
            <ion-item lines="none">
              <div class="custom-align">
                <div class="custom-align-item">
                  <ion-card-title class="justify-first">{{ game.name}}</ion-card-title>
                </div>
                <div class="custom-align-item justify-second">
                  <ion-buttons slot="end" class="justify-second">
                    <ng-container *ngIf="checkIsItFavourite(game.id); else favourite">
                      <ion-button (click)="deleteFromFavourites(game.id)"><ion-icon name="heart"></ion-icon></ion-button>
                    </ng-container>
                    <ng-template #favourite>
                      <ion-button (click)="addToFavourites(game.id)"><ion-icon name="heart-outline"></ion-icon></ion-button>
                    </ng-template>
                    <ion-button><ion-icon name="share-social"></ion-icon></ion-button>
                    <ion-button disabled class="whiteDisabled"><ion-icon name="people"></ion-icon></ion-button>
                    <ion-badge slot="end" color="secondary">{{ game.numberOfAttempts }}</ion-badge>
                  </ion-buttons>
                </div>
              </div>
            </ion-item>
            <ion-item lines="none">
              <ion-chip slot="start">{{ game.quiz ? 'Quiz' : 'Learning' }}</ion-chip>
            </ion-item>
          </ion-card-header>
          <ion-card-content>
            <ion-list lines="none">
              <ion-item>
                <ion-icon name="grid" size="small" class="rigt-padding"></ion-icon>
                <ion-label>{{ game.category }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="map" size="small" class="rigt-padding"></ion-icon>
                <ion-label>{{ game.country }}</ion-label>
              </ion-item>
            </ion-list>
            <ion-buttons class="custom-align-2">
              <ion-button class="green custom-align-item margin-top" fill="solid" size="small" shape="round" [routerLink]="['/', 'games', 'details', game.id]">
                Details
                <ion-icon slot="end" name="arrow-forward"></ion-icon>
              </ion-button>
              <ion-button class="green custom-align-item margin-top" fill="solid" size="small" shape="round" [routerLink]="['/', 'events', 'create-event']">
                Create event
                <ion-icon slot="end" name="arrow-forward"></ion-icon>
              </ion-button>
              <ion-button class="green custom-align-item margin-top" fill="solid" size="small" shape="round" [routerLink]="['/', 'game-mode']">
                Play
                <ion-icon slot="end" name="arrow-forward"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

</ion-content>
