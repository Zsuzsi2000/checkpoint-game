<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="back()">Cancel</ion-button>
    </ion-buttons>
    <ion-title>{{ isNew ? 'Find new friends' : 'Friend requests'}}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-searchbar [debounce]="1000"
                 (ionInput)="filtering($event)"
                 placeholder="Search"></ion-searchbar>
  <ion-list *ngIf="filteredUsers">
    <ion-list-header>
      <ion-label>{{ isNew ? 'Users' : 'In progress'}}</ion-label>
    </ion-list-header>
    <ion-item *ngFor="let user of filteredUsers">
      <ion-avatar slot="start">
        <img alt="Profile picture" [src]="user.user.picture"/>
      </ion-avatar>
      <ion-label>{{ user.user.username }}</ion-label>
      <ion-badge *ngIf="user.marked === 'sender'" slot="end" class="ion-no-margin">Marked</ion-badge>
      <ion-buttons slot="end" [ngSwitch]="user.marked">
        <ng-container *ngSwitchCase="'receiver'">
          <ion-button class="custom-button" size="small" (click)="confirmRequest(user.user.id)">
            <ion-label>Confirm</ion-label>
          </ion-button>
          <ion-button class="custom-button" size="small" (click)="deleteRequest(user.user.id)">
            <ion-label>Remove</ion-label>
          </ion-button>
        </ng-container>
        <ion-button *ngSwitchCase="'sender'" class="custom-button" size="small" (click)="deleteRequest(user.user.id)">
          <ion-label>Cancel</ion-label>
        </ion-button>
        <ion-button *ngSwitchCase="'none'" class="custom-button" size="small" (click)="createRequest(user.user.id)">
          <ion-label>Add</ion-label>
        </ion-button>
        <ion-button [routerLink]="['/', 'profile', user.user.id]">
          <ion-icon name="arrow-forward"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item>
  </ion-list>
</ion-content>
